#!/usr/bin/env groovy


def call(config, scansConfig) {
    stage ('Vulnerability Scans') {
        def stages = [:]
        
        scansConfig.each {
            switch (it.type) {
                case "checkmarx":
                    stages[it.type] = {
                        stage("Checkmarx") {
                            checkmarx(config, it)
                        }
                    }
                    break
                case "coverity":
                    stages[it.type] = {
                        stage("Coverity") {
                            coverity(config, it)
                        }
                    }
                default:
                    logger("Unable to parse vulnerabilityScans config item: ${it}")
                    break
            }
        }

        parallel(stages)
    }
}